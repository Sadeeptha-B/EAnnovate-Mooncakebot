[
    {
        "id": "e14103932ef35805",
        "type": "subflow",
        "name": "Deactivate Device",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "5c4b3a990fec5f20"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 580,
                "y": 80,
                "wires": [
                    {
                        "id": "cf41e3b742bf4ce6",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "DELAY",
                "type": "str",
                "value": "1"
            }
        ],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "cf41e3b742bf4ce6",
        "type": "change",
        "z": "e14103932ef35805",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "5c4b3a990fec5f20",
        "type": "delay",
        "z": "e14103932ef35805",
        "name": "",
        "pauseType": "delay",
        "timeout": "${DELAY}",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "0",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 230,
        "y": 80,
        "wires": [
            [
                "cf41e3b742bf4ce6"
            ]
        ]
    },
    {
        "id": "07202838d361698e",
        "type": "tab",
        "label": "New Working Flow",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "62dd9f04eaaaab23",
        "type": "group",
        "z": "07202838d361698e",
        "name": "Initialize variables on Factory I/O",
        "style": {
            "label": true
        },
        "nodes": [
            "c89554e8012652b9",
            "1f394a97b869587b",
            "8f77f9f6efd25196",
            "aa11c2677ca8fe76",
            "d83b77747be65e02",
            "c935ec023a6962d0",
            "5b9aa8aa6756c7d4",
            "9b415fa2b5cf0130",
            "e8d0cdd5733b18ba",
            "0986ba4e556d205f",
            "821ce2a0df4d38d2",
            "f210f2bfb84f3bf9",
            "8ad0fa5daa5619d6",
            "2ec774da02cf93ef"
        ],
        "x": 94,
        "y": 159,
        "w": 912,
        "h": 862
    },
    {
        "id": "5fd98da821e0daab",
        "type": "group",
        "z": "07202838d361698e",
        "name": "Dashboard",
        "style": {
            "label": true
        },
        "nodes": [
            "fc2ffe9a424e4565",
            "10bc22e42790edf1",
            "45f1d479e8b79e2d",
            "8dd98aaa46a33c15",
            "5eb146b1d5509979",
            "f525fc6fd58d64aa",
            "aab79647c077be42",
            "d72790466fc012ed",
            "f09a3e4231ac6e8f",
            "ca60c2a93959d53c",
            "217f1a9bf7c7b288",
            "f3050e790b4948ab",
            "68bd4d7bdd276629"
        ],
        "x": 1174,
        "y": 759,
        "w": 1312,
        "h": 482
    },
    {
        "id": "c89554e8012652b9",
        "type": "OpcUa-Server",
        "z": "07202838d361698e",
        "g": "62dd9f04eaaaab23",
        "port": "53880",
        "name": "",
        "endpoint": "",
        "users": "users.json",
        "nodesetDir": "",
        "folderName4PKI": "",
        "autoAcceptUnknownCertificate": true,
        "registerToDiscovery": false,
        "constructDefaultAddressSpace": true,
        "allowAnonymous": true,
        "endpointNone": true,
        "endpointSign": true,
        "endpointSignEncrypt": true,
        "endpointBasic128Rsa15": true,
        "endpointBasic256": true,
        "endpointBasic256Sha256": true,
        "maxNodesPerBrowse": 0,
        "maxNodesPerHistoryReadData": 0,
        "maxNodesPerHistoryReadEvents": 0,
        "maxNodesPerHistoryUpdateData": 0,
        "maxNodesPerRead": 0,
        "maxNodesPerWrite": 0,
        "maxNodesPerMethodCall": 0,
        "maxNodesPerRegisterNodes": 0,
        "maxNodesPerNodeManagement": 0,
        "maxMonitoredItemsPerCall": 0,
        "maxNodesPerHistoryUpdateEvents": 0,
        "maxNodesPerTranslateBrowsePathsToNodeIds": 0,
        "maxConnectionsPerEndpoint": "60",
        "maxMessageSize": 4096,
        "maxBufferSize": 4096,
        "x": 900,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "1f394a97b869587b",
        "type": "OpcUa-Item",
        "z": "07202838d361698e",
        "g": "62dd9f04eaaaab23",
        "item": "ns=2;s=_sensor0;datatype=Boolean",
        "datatype": "Boolean",
        "value": "0",
        "name": "_sensor0",
        "x": 540,
        "y": 200,
        "wires": [
            [
                "c89554e8012652b9"
            ]
        ]
    },
    {
        "id": "8f77f9f6efd25196",
        "type": "OpcUa-Item",
        "z": "07202838d361698e",
        "g": "62dd9f04eaaaab23",
        "item": "ns=2;s=_sensor1;datatype=Boolean",
        "datatype": "Boolean",
        "value": "0",
        "name": "_sensor1",
        "x": 540,
        "y": 280,
        "wires": [
            [
                "c89554e8012652b9"
            ]
        ]
    },
    {
        "id": "aa11c2677ca8fe76",
        "type": "OpcUa-Item",
        "z": "07202838d361698e",
        "g": "62dd9f04eaaaab23",
        "item": "ns=2;s=_sensor2;datatype=Boolean",
        "datatype": "Boolean",
        "value": "0",
        "name": "_sensor2",
        "x": 540,
        "y": 380,
        "wires": [
            [
                "c89554e8012652b9"
            ]
        ]
    },
    {
        "id": "d83b77747be65e02",
        "type": "OpcUa-Item",
        "z": "07202838d361698e",
        "g": "62dd9f04eaaaab23",
        "item": "ns=2;s=_conveyor0;datatype=Boolean;value=false",
        "datatype": "Boolean",
        "value": "",
        "name": "_conveyor0",
        "x": 550,
        "y": 480,
        "wires": [
            [
                "c89554e8012652b9"
            ]
        ]
    },
    {
        "id": "c935ec023a6962d0",
        "type": "OpcUa-Item",
        "z": "07202838d361698e",
        "g": "62dd9f04eaaaab23",
        "item": "ns=2;s=_conveyor1;datatype=Boolean;value=false",
        "datatype": "Boolean",
        "value": "",
        "name": "_conveyor1",
        "x": 550,
        "y": 540,
        "wires": [
            [
                "c89554e8012652b9"
            ]
        ]
    },
    {
        "id": "5b9aa8aa6756c7d4",
        "type": "OpcUa-Item",
        "z": "07202838d361698e",
        "g": "62dd9f04eaaaab23",
        "item": "ns=2;s=_conveyor2;datatype=Boolean;value=false",
        "datatype": "Boolean",
        "value": "",
        "name": "_conveyor2",
        "x": 550,
        "y": 600,
        "wires": [
            [
                "c89554e8012652b9"
            ]
        ]
    },
    {
        "id": "9b415fa2b5cf0130",
        "type": "OpcUa-Item",
        "z": "07202838d361698e",
        "g": "62dd9f04eaaaab23",
        "item": "ns=2;s=_conveyor3a;datatype=Boolean;value=false",
        "datatype": "Boolean",
        "value": "",
        "name": "_conveyor3a",
        "x": 550,
        "y": 680,
        "wires": [
            [
                "c89554e8012652b9"
            ]
        ]
    },
    {
        "id": "e8d0cdd5733b18ba",
        "type": "OpcUa-Item",
        "z": "07202838d361698e",
        "g": "62dd9f04eaaaab23",
        "item": "ns=2;s=_conveyor3b;datatype=Boolean;value=false",
        "datatype": "Boolean",
        "value": "",
        "name": "_conveyor3b",
        "x": 550,
        "y": 740,
        "wires": [
            [
                "c89554e8012652b9"
            ]
        ]
    },
    {
        "id": "0986ba4e556d205f",
        "type": "inject",
        "z": "07202838d361698e",
        "g": "62dd9f04eaaaab23",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"opcuaCommand\":\"addVariable\"}",
        "payloadType": "json",
        "x": 190,
        "y": 560,
        "wires": [
            [
                "1f394a97b869587b",
                "8f77f9f6efd25196",
                "aa11c2677ca8fe76",
                "d83b77747be65e02",
                "c935ec023a6962d0",
                "5b9aa8aa6756c7d4",
                "9b415fa2b5cf0130",
                "e8d0cdd5733b18ba",
                "821ce2a0df4d38d2",
                "f210f2bfb84f3bf9",
                "8ad0fa5daa5619d6",
                "2ec774da02cf93ef"
            ]
        ]
    },
    {
        "id": "1c0730e036a1f0b7",
        "type": "function",
        "z": "07202838d361698e",
        "name": "Specify current sensor",
        "func": "let sensor_no = flow.get(\"sensor_no\")\n\nmsg.topic = \"ns=2;s=_sensor\"+ sensor_no +\";datatype=Boolean\"\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1940,
        "y": 420,
        "wires": [
            [
                "ef1886a6f1fcc60d"
            ]
        ]
    },
    {
        "id": "ef1886a6f1fcc60d",
        "type": "OpcUa-Client",
        "z": "07202838d361698e",
        "endpoint": "df2f1b827a0d1854",
        "action": "read",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": 10,
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "folderName4PKI": "",
        "name": "",
        "x": 2160,
        "y": 420,
        "wires": [
            [
                "ee26388a53c9c31f"
            ]
        ]
    },
    {
        "id": "ee26388a53c9c31f",
        "type": "function",
        "z": "07202838d361698e",
        "name": "Track order status",
        "func": "let sensor_no = flow.get(\"sensor_no\")\nlet order_no = flow.get(\"orders\")\nlet complete_orders = flow.get(\"completed_orders\")\nlet prevSenReading = flow.get(\"previousSensorReading\")\nmsg.completeFlavor = \"false\";\nmsg.completeOrder = \"false\";\n\nif(msg.payload & !prevSenReading){\n    prevSenReading = true\n    complete_orders[sensor_no] += 1\n    flow.set(\"completed_orders\", complete_orders)\n} else{\n    prevSenReading = false\n}\n\nif(complete_orders[sensor_no] >= order_no[sensor_no]){\n        // Turn on conveyor here\n        msg.emit = \"false\"\n        sensor_no += 1\n        if(sensor_no >= order_no.length){\n            msg.completeOrder = \"true\";\n        }\n        flow.set(\"sensor_no\", sensor_no)\n        msg.completeFlavor = \"true\"\n}\nflow.set(\"previousSensorReading\", prevSenReading)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2390,
        "y": 420,
        "wires": [
            [
                "cdd6b45bc7aae9f1",
                "8b9f067aa5c14bb7",
                "4b3dcd56c3c9d186",
                "10c82e265e3fd77d"
            ]
        ]
    },
    {
        "id": "ca82f732ae5b2c17",
        "type": "OpcUa-Client",
        "z": "07202838d361698e",
        "endpoint": "df2f1b827a0d1854",
        "action": "write",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": 10,
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "folderName4PKI": "",
        "name": "",
        "x": 3340,
        "y": 420,
        "wires": [
            [
                "26f7ffa681a82a6b"
            ]
        ]
    },
    {
        "id": "821ce2a0df4d38d2",
        "type": "OpcUa-Item",
        "z": "07202838d361698e",
        "g": "62dd9f04eaaaab23",
        "item": "ns=2;s=_Emitter0;datatype=Boolean;value=false",
        "datatype": "Boolean",
        "value": "0",
        "name": "_Emitter0",
        "x": 540,
        "y": 800,
        "wires": [
            [
                "c89554e8012652b9"
            ]
        ]
    },
    {
        "id": "f210f2bfb84f3bf9",
        "type": "OpcUa-Item",
        "z": "07202838d361698e",
        "g": "62dd9f04eaaaab23",
        "item": "ns=2;s=_Emitter1;datatype=Boolean;value=false",
        "datatype": "Boolean",
        "value": "0",
        "name": "_Emitter1",
        "x": 540,
        "y": 860,
        "wires": [
            [
                "c89554e8012652b9"
            ]
        ]
    },
    {
        "id": "8ad0fa5daa5619d6",
        "type": "OpcUa-Item",
        "z": "07202838d361698e",
        "g": "62dd9f04eaaaab23",
        "item": "ns=2;s=_Emitter2;datatype=Boolean;value=false",
        "datatype": "Boolean",
        "value": "0",
        "name": "_Emitter2",
        "x": 540,
        "y": 920,
        "wires": [
            [
                "c89554e8012652b9"
            ]
        ]
    },
    {
        "id": "5b86ae00b8475974",
        "type": "OpcUa-Client",
        "z": "07202838d361698e",
        "endpoint": "df2f1b827a0d1854",
        "action": "write",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": 10,
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "folderName4PKI": "",
        "name": "",
        "x": 3800,
        "y": 420,
        "wires": [
            [
                "6cd1e64e65db0b7a"
            ]
        ]
    },
    {
        "id": "cdd6b45bc7aae9f1",
        "type": "switch",
        "z": "07202838d361698e",
        "name": "Check if a flavor is complete",
        "property": "completeFlavor",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "true",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 2680,
        "y": 420,
        "wires": [
            [
                "7692118f3de9efed",
                "6b11736eb5b75c10"
            ]
        ]
    },
    {
        "id": "8887f9912e97fa90",
        "type": "change",
        "z": "07202838d361698e",
        "name": "Start conveyor belt",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "ns=2;s=_conveyor3a;datatype=Boolean",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3150,
        "y": 420,
        "wires": [
            [
                "ca82f732ae5b2c17"
            ]
        ]
    },
    {
        "id": "7692118f3de9efed",
        "type": "delay",
        "z": "07202838d361698e",
        "name": "Await box fall",
        "pauseType": "delay",
        "timeout": "1.65",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 2930,
        "y": 420,
        "wires": [
            [
                "8887f9912e97fa90"
            ]
        ]
    },
    {
        "id": "b214072587eff565",
        "type": "trigger",
        "z": "07202838d361698e",
        "name": "Polling loop",
        "op1": "",
        "op2": "",
        "op1type": "date",
        "op2type": "date",
        "duration": "-600",
        "extend": false,
        "overrideDelay": false,
        "units": "ms",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1730,
        "y": 420,
        "wires": [
            [
                "1c0730e036a1f0b7",
                "47d077130a62ab4c"
            ]
        ]
    },
    {
        "id": "8b9f067aa5c14bb7",
        "type": "switch",
        "z": "07202838d361698e",
        "name": "Check if order is complete",
        "property": "completeOrder",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "true",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 2670,
        "y": 540,
        "wires": [
            [
                "255e357383ca54ab"
            ]
        ]
    },
    {
        "id": "135f2e293e071e9d",
        "type": "change",
        "z": "07202838d361698e",
        "name": "Start second conveyor belt",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "ns=2;s=_conveyor3b;datatype=Boolean",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3120,
        "y": 540,
        "wires": [
            [
                "13328098c93ce066"
            ]
        ]
    },
    {
        "id": "255e357383ca54ab",
        "type": "delay",
        "z": "07202838d361698e",
        "name": "Await box fall",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 2890,
        "y": 540,
        "wires": [
            [
                "135f2e293e071e9d"
            ]
        ]
    },
    {
        "id": "13328098c93ce066",
        "type": "OpcUa-Client",
        "z": "07202838d361698e",
        "endpoint": "df2f1b827a0d1854",
        "action": "write",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": 10,
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "folderName4PKI": "",
        "name": "",
        "x": 3360,
        "y": 540,
        "wires": [
            [
                "a931545678aa9335"
            ]
        ]
    },
    {
        "id": "62751312bbae5c7a",
        "type": "OpcUa-Client",
        "z": "07202838d361698e",
        "endpoint": "df2f1b827a0d1854",
        "action": "write",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": 10,
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "folderName4PKI": "",
        "name": "",
        "x": 3900,
        "y": 540,
        "wires": [
            [
                "6b11736eb5b75c10"
            ]
        ]
    },
    {
        "id": "6b11736eb5b75c10",
        "type": "change",
        "z": "07202838d361698e",
        "name": "Reset polling loop",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "",
                "tot": "date"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1510,
        "y": 200,
        "wires": [
            [
                "b214072587eff565"
            ]
        ]
    },
    {
        "id": "6cd1e64e65db0b7a",
        "type": "change",
        "z": "07202838d361698e",
        "name": "Restarts polling loop",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "date"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1520,
        "y": 60,
        "wires": [
            [
                "b214072587eff565"
            ]
        ]
    },
    {
        "id": "fc2ffe9a424e4565",
        "type": "ui_numeric",
        "z": "07202838d361698e",
        "g": "5fd98da821e0daab",
        "name": "White Lotus Picker",
        "label": "White Lotus ",
        "tooltip": "",
        "group": "e51d160d9081bf98",
        "order": 1,
        "width": 0,
        "height": 0,
        "wrap": false,
        "passthru": false,
        "topic": "payload",
        "topicType": "msg",
        "format": "{{value}}",
        "min": 0,
        "max": "3",
        "step": 1,
        "className": "",
        "x": 2070,
        "y": 860,
        "wires": [
            [
                "8dd98aaa46a33c15"
            ]
        ]
    },
    {
        "id": "10bc22e42790edf1",
        "type": "ui_numeric",
        "z": "07202838d361698e",
        "g": "5fd98da821e0daab",
        "name": "Red Bean Picker",
        "label": "Red Bean",
        "tooltip": "",
        "group": "e51d160d9081bf98",
        "order": 1,
        "width": 0,
        "height": 0,
        "wrap": false,
        "passthru": false,
        "topic": "payload",
        "topicType": "msg",
        "format": "{{value}}",
        "min": 0,
        "max": "3",
        "step": 1,
        "className": "",
        "x": 2070,
        "y": 920,
        "wires": [
            [
                "5eb146b1d5509979"
            ]
        ]
    },
    {
        "id": "45f1d479e8b79e2d",
        "type": "ui_numeric",
        "z": "07202838d361698e",
        "g": "5fd98da821e0daab",
        "name": "Green Tea Picker",
        "label": "Green Tea",
        "tooltip": "",
        "group": "e51d160d9081bf98",
        "order": 1,
        "width": 0,
        "height": 0,
        "wrap": false,
        "passthru": false,
        "topic": "payload",
        "topicType": "msg",
        "format": "{{value}}",
        "min": 0,
        "max": "3",
        "step": 1,
        "className": "",
        "x": 2070,
        "y": 980,
        "wires": [
            [
                "f525fc6fd58d64aa"
            ]
        ]
    },
    {
        "id": "8dd98aaa46a33c15",
        "type": "function",
        "z": "07202838d361698e",
        "g": "5fd98da821e0daab",
        "name": "Set White Lotus Amount",
        "func": "let orders = flow.get(\"orders\")\norders[0] = msg.payload\nflow.set(\"orders\", orders)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2350,
        "y": 860,
        "wires": [
            []
        ]
    },
    {
        "id": "5eb146b1d5509979",
        "type": "function",
        "z": "07202838d361698e",
        "g": "5fd98da821e0daab",
        "name": "Set Red Bean Amount",
        "func": "let orders = flow.get(\"orders\")\norders[1] = msg.payload\nflow.set(\"orders\", orders)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2340,
        "y": 920,
        "wires": [
            []
        ]
    },
    {
        "id": "f525fc6fd58d64aa",
        "type": "function",
        "z": "07202838d361698e",
        "g": "5fd98da821e0daab",
        "name": "Set Green Tea Amount",
        "func": "let orders = flow.get(\"orders\")\norders[2] = msg.payload\nflow.set(\"orders\", orders)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2340,
        "y": 980,
        "wires": [
            []
        ]
    },
    {
        "id": "aab79647c077be42",
        "type": "ui_button",
        "z": "07202838d361698e",
        "g": "5fd98da821e0daab",
        "name": "",
        "group": "e51d160d9081bf98",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Confirm",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 1260,
        "y": 800,
        "wires": [
            [
                "d72790466fc012ed",
                "c3a90a9e57de977b",
                "f3050e790b4948ab",
                "a98fa52ac868d160"
            ]
        ]
    },
    {
        "id": "d72790466fc012ed",
        "type": "function",
        "z": "07202838d361698e",
        "g": "5fd98da821e0daab",
        "name": "Disable input upon accepting order",
        "func": "msg.enabled = false;\ndelete msg.payload;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1620,
        "y": 800,
        "wires": [
            [
                "fc2ffe9a424e4565",
                "10bc22e42790edf1",
                "45f1d479e8b79e2d",
                "aab79647c077be42"
            ]
        ]
    },
    {
        "id": "f09a3e4231ac6e8f",
        "type": "ui_button",
        "z": "07202838d361698e",
        "g": "5fd98da821e0daab",
        "name": "",
        "group": "e51d160d9081bf98",
        "order": 7,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Reset",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 1250,
        "y": 1140,
        "wires": [
            [
                "ca60c2a93959d53c",
                "68bd4d7bdd276629"
            ]
        ]
    },
    {
        "id": "ca60c2a93959d53c",
        "type": "function",
        "z": "07202838d361698e",
        "g": "5fd98da821e0daab",
        "name": "Enable input upon reset",
        "func": "msg.enabled = true;\nmsg.payload = \"\"\nflow.set(\"orders\",[0,0,0]);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1510,
        "y": 1140,
        "wires": [
            [
                "10bc22e42790edf1",
                "fc2ffe9a424e4565",
                "45f1d479e8b79e2d",
                "aab79647c077be42"
            ]
        ]
    },
    {
        "id": "217f1a9bf7c7b288",
        "type": "ui_text",
        "z": "07202838d361698e",
        "g": "5fd98da821e0daab",
        "group": "e51d160d9081bf98",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "Status Indicator",
        "label": "Status",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2060,
        "y": 1040,
        "wires": []
    },
    {
        "id": "6cad6b636d0f3cd6",
        "type": "function",
        "z": "07202838d361698e",
        "name": "Initialize Variables",
        "func": "flow.set(\"sensor_no\",0)\nflow.set(\"completed_orders\", [0,0,0])\nflow.set(\"previousSensorReading\", false)\n\nmsg.payload = flow.get(\"completed_orders\")\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1530,
        "y": 420,
        "wires": [
            [
                "b214072587eff565"
            ]
        ]
    },
    {
        "id": "4b3dcd56c3c9d186",
        "type": "switch",
        "z": "07202838d361698e",
        "name": "Check if all sensors polled",
        "property": "sensor_no",
        "propertyType": "flow",
        "rules": [
            {
                "t": "cont",
                "v": "3",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 2670,
        "y": 360,
        "wires": [
            [
                "6b11736eb5b75c10"
            ]
        ]
    },
    {
        "id": "2ec774da02cf93ef",
        "type": "OpcUa-Item",
        "z": "07202838d361698e",
        "g": "62dd9f04eaaaab23",
        "item": "ns=2;s=_Emitter3;datatype=Boolean;value=false",
        "datatype": "Boolean",
        "value": "0",
        "name": "_Emitter3",
        "x": 540,
        "y": 980,
        "wires": [
            [
                "c89554e8012652b9"
            ]
        ]
    },
    {
        "id": "c3a90a9e57de977b",
        "type": "change",
        "z": "07202838d361698e",
        "name": "Start conveyor belt",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "ns=2;s=_conveyor3a;datatype=Boolean",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1530,
        "y": 540,
        "wires": [
            [
                "66ada56e24db8da1"
            ]
        ]
    },
    {
        "id": "66ada56e24db8da1",
        "type": "OpcUa-Client",
        "z": "07202838d361698e",
        "endpoint": "df2f1b827a0d1854",
        "action": "write",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": 10,
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "folderName4PKI": "",
        "name": "",
        "x": 1760,
        "y": 540,
        "wires": [
            [
                "39b631209965ebcc"
            ]
        ]
    },
    {
        "id": "f6f02b91b37741ad",
        "type": "OpcUa-Client",
        "z": "07202838d361698e",
        "endpoint": "df2f1b827a0d1854",
        "action": "write",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": 10,
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "folderName4PKI": "",
        "name": "",
        "x": 2380,
        "y": 540,
        "wires": [
            [
                "6cad6b636d0f3cd6"
            ]
        ]
    },
    {
        "id": "f3050e790b4948ab",
        "type": "change",
        "z": "07202838d361698e",
        "g": "5fd98da821e0daab",
        "name": "Notify Order success",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Order is successful",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1580,
        "y": 880,
        "wires": [
            [
                "217f1a9bf7c7b288"
            ]
        ]
    },
    {
        "id": "68bd4d7bdd276629",
        "type": "change",
        "z": "07202838d361698e",
        "g": "5fd98da821e0daab",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1520,
        "y": 1200,
        "wires": [
            [
                "217f1a9bf7c7b288"
            ]
        ]
    },
    {
        "id": "a98fa52ac868d160",
        "type": "change",
        "z": "07202838d361698e",
        "name": "Emit new stackable box",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "ns=2;s=_Emitter3;datatype=Boolean",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1550,
        "y": 620,
        "wires": [
            [
                "0b0d5140a728bfdd"
            ]
        ]
    },
    {
        "id": "0b0d5140a728bfdd",
        "type": "OpcUa-Client",
        "z": "07202838d361698e",
        "endpoint": "df2f1b827a0d1854",
        "action": "write",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": 10,
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "folderName4PKI": "",
        "name": "",
        "x": 1780,
        "y": 620,
        "wires": [
            [
                "5a0e0eab2c6b1707"
            ]
        ]
    },
    {
        "id": "e7da5acbeb66714e",
        "type": "OpcUa-Client",
        "z": "07202838d361698e",
        "endpoint": "df2f1b827a0d1854",
        "action": "write",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": 10,
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "folderName4PKI": "",
        "name": "",
        "x": 2360,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "5a0e0eab2c6b1707",
        "type": "subflow:e14103932ef35805",
        "z": "07202838d361698e",
        "name": "Stop emitting stackable boxes",
        "x": 2050,
        "y": 620,
        "wires": [
            [
                "e7da5acbeb66714e"
            ]
        ]
    },
    {
        "id": "39b631209965ebcc",
        "type": "subflow:e14103932ef35805",
        "z": "07202838d361698e",
        "name": "Let box move and stop conveyor belt",
        "env": [
            {
                "name": "DELAY",
                "value": "3",
                "type": "str"
            }
        ],
        "x": 2070,
        "y": 540,
        "wires": [
            [
                "f6f02b91b37741ad"
            ]
        ]
    },
    {
        "id": "a931545678aa9335",
        "type": "subflow:e14103932ef35805",
        "z": "07202838d361698e",
        "name": "Stop second conveyor belt after wait",
        "env": [
            {
                "name": "DELAY",
                "value": "3",
                "type": "str"
            }
        ],
        "x": 3630,
        "y": 540,
        "wires": [
            [
                "62751312bbae5c7a"
            ]
        ]
    },
    {
        "id": "26f7ffa681a82a6b",
        "type": "subflow:e14103932ef35805",
        "z": "07202838d361698e",
        "name": "Stop conveyor belt",
        "env": [
            {
                "name": "DELAY",
                "value": "3.9",
                "type": "str"
            }
        ],
        "x": 3550,
        "y": 420,
        "wires": [
            [
                "5b86ae00b8475974"
            ]
        ]
    },
    {
        "id": "21a9285363e9c98d",
        "type": "link in",
        "z": "07202838d361698e",
        "name": "",
        "links": [],
        "x": 1035,
        "y": 1080,
        "wires": [
            []
        ]
    },
    {
        "id": "7a35a17fe230a6ab",
        "type": "change",
        "z": "07202838d361698e",
        "name": "Turn off Emitter",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3380,
        "y": 200,
        "wires": [
            [
                "6e4cd4fe5dbad995"
            ]
        ]
    },
    {
        "id": "6e4cd4fe5dbad995",
        "type": "OpcUa-Client",
        "z": "07202838d361698e",
        "endpoint": "df2f1b827a0d1854",
        "action": "write",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": 10,
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "folderName4PKI": "",
        "name": "",
        "x": 3580,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "1a282daa693673be",
        "type": "switch",
        "z": "07202838d361698e",
        "name": "Is emitting complete?",
        "property": "emit",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "false",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 3180,
        "y": 200,
        "wires": [
            [
                "7a35a17fe230a6ab"
            ]
        ]
    },
    {
        "id": "b29d5a5091c7b8c8",
        "type": "OpcUa-Client",
        "z": "07202838d361698e",
        "endpoint": "df2f1b827a0d1854",
        "action": "write",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": 10,
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "folderName4PKI": "",
        "name": "",
        "x": 3040,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "b56980b84511d907",
        "type": "switch",
        "z": "07202838d361698e",
        "name": "Check if emitting is needed",
        "property": "emit",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "true",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 2580,
        "y": 60,
        "wires": [
            [
                "b1bb7a896bd0b035"
            ]
        ]
    },
    {
        "id": "47d077130a62ab4c",
        "type": "function",
        "z": "07202838d361698e",
        "name": "Track emission",
        "func": "let orders = flow.get(\"orders\")\nlet completed_orders = flow.get(\"completed_orders\")\nlet sensor_no = flow.get(\"sensor_no\")\nmsg.topic = \"ns=2;s=_Emitter\"+sensor_no+\";datatype=Boolean\"\nif(completed_orders[sensor_no] < orders[sensor_no]){\n    msg.emit = \"true\"\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2340,
        "y": 60,
        "wires": [
            [
                "b56980b84511d907"
            ]
        ]
    },
    {
        "id": "10c82e265e3fd77d",
        "type": "function",
        "z": "07202838d361698e",
        "name": "Get current emitter",
        "func": "let sensor_no = flow.get(\"sensor_no\") - 1\n\nmsg.topic = \"ns=2;s=_Emitter\"+sensor_no+\";datatype=Boolean\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2970,
        "y": 200,
        "wires": [
            [
                "1a282daa693673be"
            ]
        ]
    },
    {
        "id": "b1bb7a896bd0b035",
        "type": "change",
        "z": "07202838d361698e",
        "name": "Turn on Emitter",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2840,
        "y": 60,
        "wires": [
            [
                "b29d5a5091c7b8c8"
            ]
        ]
    },
    {
        "id": "df2f1b827a0d1854",
        "type": "OpcUa-Endpoint",
        "endpoint": "opc.tcp://127.0.0.1:53880",
        "secpol": "None",
        "secmode": "None",
        "none": false,
        "login": false,
        "usercert": false,
        "usercertificate": "",
        "userprivatekey": ""
    },
    {
        "id": "e51d160d9081bf98",
        "type": "ui_group",
        "name": "Orders",
        "tab": "8648135d667d9e91",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "8648135d667d9e91",
        "type": "ui_tab",
        "name": "Home",
        "icon": "dashboard",
        "disabled": false,
        "hidden": false
    }
]